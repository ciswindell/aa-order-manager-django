{% extends "core/base.html" %}

{% block title %}Dashboard - AA Order Manager{% endblock %}

{% block content %}
<div class="dashboard">
    <h2>Welcome, {{ user.username }}!</h2>

    {% if is_staff %}
    <div class="admin-link">
        <a href="{% url 'admin:index' %}">Django Admin</a>
        | <a href="{% url 'integrations:manage' %}">Manage Integrations</a>
    </div>
    {% endif %}

    <div class="integrations-cta">
        {% load integration_cta %}
        {% integration_cta 'dropbox' user %}
        {# {% integration_cta 'basecamp' user %} #}
    </div>

    {# Maintain legacy messages for existing tests #}
    {% with db=integration_statuses.dropbox %}
        {% if db and not db.connected %}
        <div class="dropbox-banner">
            <p>Dropbox is not connected.</p>
        </div>
        {% endif %}
        {% if user.is_staff and db and db.reason == 'Missing app credentials' %}
        <div class="warning">
            <strong>Warning:</strong> Dropbox app credentials are not configured. Please check your environment variables.
        </div>
        {% endif %}
    {% endwith %}

    <div class="logout">
        <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button type="submit">Logout</button>
        </form>
    </div>
</div>
{% endblock %}
